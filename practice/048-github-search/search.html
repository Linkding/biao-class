<style>
    img {
        max-width: 100px;
    }

    #user-list {
        padding: 200px;
    }

    .user {
        padding: 5px;
        background: rgba(0%, 0%, 0%, .3)
    }

    #user-list>* {
        display: inline-block;
    }
</style>
<h1>Github用户搜索</h1>
<form id="form-search" autocomplete="off">
    <input type="text" id="search-input" placeholder="请输入">
    <button type="submit">搜一下</button>
</form>
<div class="count"></div>
<div id="user-list"></div>
<script>
    // 小结：注意render渲染放到请求函数回调，在返回数据后执行，如果单独执行会因为数据没有返回而无法渲染；

    // 获取增加html的元素
    var el_user_list = document.querySelector('#user-list')
        ,form = document.querySelector('#form-search')
        ,input = document.querySelector('#search-input')
        ,res
    // 入口函数
    init();
    
    function init (){
        detect_user();
    };
    // 监听用户输入查找事件
    function detect_user(){
        form.addEventListener('submit',function(e){
            e.preventDefault();
            var key = input.value
            send(key)
        })
    }
    // 通过关键字搜索github用户
    // * @param  String key 关键字
    function send(key,method){
        // 默认方法 get
        method = method ||'get'
        // 准备发射
        var http = new XMLHttpRequest();
        http.open(method,'https://api.github.com/search/users?q='+ key);
        // 发送请求
        http.send()
        
        // 返回请求后
        http.addEventListener('load',function(){
            // 将数据json化
            var data = JSON.parse(this.responseText);
            // 将数据赋值预先定义的res
            res = data;
            // 渲染页面
            render();
        })
    }
    // 渲染动作函数
    function render(){
        // 定义一个空的字符串，用于插入html内容
        var html = ''
        // 遍历返回的json数据，获取需要的数据
        res.items.forEach(function(user){
            // 拼接html内容
            html = html + 
            `
            <div class="user">
                <div class="logo">
                <img src="${user.avatar_url}">
                </div>
                <div class="info">${user.login}</div>
            </div>
            `
        })
        // 插入对应的页面位置
        el_user_list.innerHTML = html;
    }


</script>

